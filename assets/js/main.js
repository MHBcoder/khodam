
const newSoundsData = [
  {
    id: 1,
    img: "./assets/media/img/sheikh-mahmood-abadi.jpg",
    title: "شیخ علی محمود آبادی",
    subTitle: "شهادت حضرت امام هادی (ع)",
    audio: "./assets/media/sounds/1.mp3",
    paragraf: `میبینی بند دلم پاره شده
    دخترت تو صحرا آواره شده
    پاشو که میون این حرومیا
    صحبت غارت گهواره شده
    دور تو یه عده کردن شادی
    با لب تشنه دیدم جون دادی
    نیزه رو وقتی به پهلوت میزد یاد درد مادرم افتادی
    وای من وای من ای حسین
    رو خاک صحرا چرا میزدنت
    بمیرم که بی هوا میزدنت
    جون من به لب رسید تا دیدم
    پیر مردا با عصا میزدنت
    زیرو رو شد بدنت واویلا
    خاک و خون شد کفنت واویلا
    جوری گیر افتادی تو اون گودال
    پاره شد پیروهنت واویلا
    وای من وای من ای حسین`,
  },
  {
    id: 2,
    img: "./assets/media/img/khiabani.jpg",
    title: "کربلایی وحید خیابانی",
    subTitle: "شهادت حضرت زهرا (س)",
    audio: "./assets/media/sounds/1.mp3",
    paragraf: `میبینی بند دلم پاره شده
    دخترت تو صحرا آواره شده
    پاشو که میون این حرومیا
    صحبت غارت گهواره شده
    دور تو یه عده کردن شادی
    با لب تشنه دیدم جون دادی
    نیزه رو وقتی به پهلوت میزد یاد درد مادرم افتادی
    وای من وای من ای حسین
    رو خاک صحرا چرا میزدنت
    بمیرم که بی هوا میزدنت
    جون من به لب رسید تا دیدم
    پیر مردا با عصا میزدنت
    زیرو رو شد بدنت واویلا
    خاک و خون شد کفنت واویلا
    جوری گیر افتادی تو اون گودال
    پاره شد پیروهنت واویلا
    وای من وای من ای حسین`,
  },
  {
    id: 3,
    img: "./assets/media/img/taha.jpg",
    title: "کربلایی طاها بیک محمدلو",
    subTitle: "شهادت حضرت زهرا (س)",
    audio: "./assets/media/sounds/1.mp3",
    paragraf: `میبینی بند دلم پاره شده
    دخترت تو صحرا آواره شده
    پاشو که میون این حرومیا
    صحبت غارت گهواره شده
    دور تو یه عده کردن شادی
    با لب تشنه دیدم جون دادی
    نیزه رو وقتی به پهلوت میزد یاد درد مادرم افتادی
    وای من وای من ای حسین
    رو خاک صحرا چرا میزدنت
    بمیرم که بی هوا میزدنت
    جون من به لب رسید تا دیدم
    پیر مردا با عصا میزدنت
    زیرو رو شد بدنت واویلا
    خاک و خون شد کفنت واویلا
    جوری گیر افتادی تو اون گودال
    پاره شد پیروهنت واویلا
    وای من وای من ای حسین`,
  },
  {
    id: 4,
    img: "./assets/media/img/taha.jpg",
    title: "کربلایی طاها بیک محمدلو",
    subTitle: "شهادت حضرت زهرا (س)",
    audio: "./assets/media/sounds/1.mp3",
    paragraf: `میبینی بند دلم پاره شده
    دخترت تو صحرا آواره شده
    پاشو که میون این حرومیا
    صحبت غارت گهواره شده
    دور تو یه عده کردن شادی
    با لب تشنه دیدم جون دادی
    نیزه رو وقتی به پهلوت میزد یاد درد مادرم افتادی
    وای من وای من ای حسین
    رو خاک صحرا چرا میزدنت
    بمیرم که بی هوا میزدنت
    جون من به لب رسید تا دیدم
    پیر مردا با عصا میزدنت
    زیرو رو شد بدنت واویلا
    خاک و خون شد کفنت واویلا
    جوری گیر افتادی تو اون گودال
    پاره شد پیروهنت واویلا
    وای من وای من ای حسین`,
  },
  {
    id: 5,
    img: "./assets/media/img/taha.jpg",
    title: "کربلایی طاها بیک محمدلو",
    subTitle: "شهادت حضرت زهرا (س)",
    audio: "./assets/media/sounds/1.mp3",
    paragraf: `میبینی بند دلم پاره شده
    دخترت تو صحرا آواره شده
    پاشو که میون این حرومیا
    صحبت غارت گهواره شده
    دور تو یه عده کردن شادی
    با لب تشنه دیدم جون دادی
    نیزه رو وقتی به پهلوت میزد یاد درد مادرم افتادی
    وای من وای من ای حسین
    رو خاک صحرا چرا میزدنت
    بمیرم که بی هوا میزدنت
    جون من به لب رسید تا دیدم
    پیر مردا با عصا میزدنت
    زیرو رو شد بدنت واویلا
    خاک و خون شد کفنت واویلا
    جوری گیر افتادی تو اون گودال
    پاره شد پیروهنت واویلا
    وای من وای من ای حسین`,
  },
  {
    id: 6,
    img: "./assets/media/img/taha.jpg",
    title: "کربلایی طاها بیک محمدلو",
    subTitle: "شهادت حضرت زهرا (س)",
    audio: "./assets/media/sounds/1.mp3",
    paragraf: `میبینی بند دلم پاره شده
    دخترت تو صحرا آواره شده
    پاشو که میون این حرومیا
    صحبت غارت گهواره شده
    دور تو یه عده کردن شادی
    با لب تشنه دیدم جون دادی
    نیزه رو وقتی به پهلوت میزد یاد درد مادرم افتادی
    وای من وای من ای حسین
    رو خاک صحرا چرا میزدنت
    بمیرم که بی هوا میزدنت
    جون من به لب رسید تا دیدم
    پیر مردا با عصا میزدنت
    زیرو رو شد بدنت واویلا
    خاک و خون شد کفنت واویلا
    جوری گیر افتادی تو اون گودال
    پاره شد پیروهنت واویلا
    وای من وای من ای حسین`,
  },
  {
    id: 7,
    img: "./assets/media/img/taha.jpg",
    title: "کربلایی طاها بیک محمدلو",
    subTitle: "شهادت حضرت زهرا (س)",
    audio: "./assets/media/sounds/1.mp3",
    paragraf: `میبینی بند دلم پاره شده
    دخترت تو صحرا آواره شده
    پاشو که میون این حرومیا
    صحبت غارت گهواره شده
    دور تو یه عده کردن شادی
    با لب تشنه دیدم جون دادی
    نیزه رو وقتی به پهلوت میزد یاد درد مادرم افتادی
    وای من وای من ای حسین
    رو خاک صحرا چرا میزدنت
    بمیرم که بی هوا میزدنت
    جون من به لب رسید تا دیدم
    پیر مردا با عصا میزدنت
    زیرو رو شد بدنت واویلا
    خاک و خون شد کفنت واویلا
    جوری گیر افتادی تو اون گودال
    پاره شد پیروهنت واویلا
    وای من وای من ای حسین`,
  },
];

const containerBody = document.querySelector('.container-body');
const containerSwiper = document.querySelector('.mySwiper');

newSoundsData.forEach(item => {
  let parentSlider = document.createElement('swiper-slide');

  let imgSlide = document.createElement('img');
  imgSlide.src = item.img;

  let titleSlide = document.createElement('p');
  titleSlide.className = 'title';
  titleSlide.innerHTML = item.title;

  let subTitleSlide = document.createElement('p');
  subTitleSlide.className = 'sub-title';
  subTitleSlide.innerHTML = item.subTitle;

  parentSlider.append(imgSlide, titleSlide, subTitleSlide);
  containerSwiper.append(parentSlider);

  parentSlider.addEventListener('click', () => {
    containerBody.style.display = 'none';

    // Change the URL without reloading the page
    window.history.pushState({ soundId: item.id }, '', `?id=${item.id}`);

    renderContentSound();  // Call the render function to display the new content
  });
});

const contentSound = document.querySelector('.content-sound');

function renderContentSound() {
  const urlParams = new URLSearchParams(window.location.search);
  const soundId = parseInt(urlParams.get('id'));

  const soundData = newSoundsData.find(item => item.id === soundId);

  if (!soundData) return;  // In case the ID is not found

  contentSound.innerHTML = "";

  // Create img element
  const imgElem = document.createElement("img");
  imgElem.src = soundData.img;
  imgElem.alt = soundData.title;

  // Create title
  const spanName = document.createElement("h3");
  spanName.innerHTML = soundData.title;
  spanName.className = "title-detail";

  // Create audio element
  const audioElem = document.createElement("audio");
  audioElem.src = soundData.audio;
  audioElem.controls = true;

  // Create paragraf element
  const paragrafAudio = document.createElement("p");
  paragrafAudio.innerHTML = soundData.paragraf;

  // Slice paragraf to show shorter version initially
  slicedParagraf(paragrafAudio);

  // Create button to show full text
  const notSlicedBtn = document.createElement("button");
  notSlicedBtn.innerHTML = "ادامه متن";
  notSlicedBtn.className = "btn-slice";
  notSlicedBtn.onclick = function () {
    paragrafAudio.innerHTML = soundData.paragraf;
    notSlicedBtn.style.display = "none";  // Hide the button once clicked
  };

  // Append all elements
  contentSound.append(imgElem, spanName, audioElem, paragrafAudio, notSlicedBtn);
}

// Function to slice the paragraph for initial view
function slicedParagraf(paragrafAudio) {
  const maxLength = 400;  // Adjust the max length of the sliced text
  if (paragrafAudio.innerHTML.length > maxLength) {
    paragrafAudio.innerHTML = paragrafAudio.innerHTML.substring(0, maxLength) + '...';
  }
}

// Handle the back button (popstate event)
window.addEventListener('popstate', (event) => {
  if (event.state) {
    // Go back to the main page (container-body visible)
    containerBody.style.display = 'block';
    contentSound.innerHTML = "";  // Clear the content
  } else {
    // If there's no state (back from a specific content page), show the main page
    containerBody.style.display = 'block';
    contentSound.innerHTML = "";
  }
});
